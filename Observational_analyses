###Observational bidirectional analyses of platelet phenotypes of common infections###

#Read in relevant packages
library(dplyr)

#Read in data
data <- read.table()

Subset each exposures of interest with each outcome of interest, plus covariates
t.plt.TG.sag1 <- data[c("FID", "IID", "PLT_initial_SD", "TG_SAG1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.cmv.pp52 <- data[c("FID", "IID", "PLT_initial_SD", "CMV_pp52_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.ebv.ead <- data[c("FID", "IID", "PLT_initial_SD", "EBV_EAD_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.ebv.ebna <- data[c("FID", "IID", "PLT_initial_SD", "EBV_EBNA_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.ebv.vcap18 <- data[c("FID", "IID", "PLT_initial_SD", "EBV_VCAp18_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.ebv.zebra <- data[c("FID", "IID", "PLT_initial_SD", "EBV_ZEBRA_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.hhv6.IE1A <- data[c("FID", "IID", "PLT_initial_SD", "HHV6_IE1A_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.hhv7.u14 <- data[c("FID", "IID", "PLT_initial_SD", "HHV7_U14_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.hsv1.1gG <- data[c("FID", "IID", "PLT_initial_SD", "HSV1_1gG_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.vsv.gEgI <- data[c("FID", "IID", "PLT_initial_SD", "VSV_gEgI_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.bkv.vp1 <- data[c("FID", "IID", "PLT_initial_SD", "BKV_VP1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.jcv.vp1 <- data[c("FID", "IID", "PLT_initial_SD", "JCV_VP1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.plt.mcv.vp1 <- data[c("FID", "IID", "PLT_initial_SD", "MCV_VP1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.TG.sag1 <- data[c("FID", "IID", "MPV_initial_SD", "TG_SAG1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.cmv.pp52 <- data[c("FID", "IID", "MPV_initial_SD", "CMV_pp52_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.ebv.ead <- data[c("FID", "IID", "MPV_initial_SD", "EBV_EAD_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.ebv.ebna <- data[c("FID", "IID", "MPV_initial_SD", "EBV_EBNA_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.ebv.vcap18 <- data[c("FID", "IID", "MPV_initial_SD", "EBV_VCAp18_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.ebv.zebra <- data[c("FID", "IID", "MPV_initial_SD", "EBV_ZEBRA_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.hhv6.IE1A <- data[c("FID", "IID", "MPV_initial_SD", "HHV6_IE1A_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.hhv7.u14 <- data[c("FID", "IID", "MPV_initial_SD", "HHV7_U14_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.hsv1.1gG <- data[c("FID", "IID", "MPV_initial_SD", "HSV1_1gG_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.vsv.gEgI <- data[c("FID", "IID", "MPV_initial_SD", "VSV_gEgI_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.bkv.vp1 <- data[c("FID", "IID", "MPV_initial_SD", "BKV_VP1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.jcv.vp1 <- data[c("FID", "IID", "MPV_initial_SD", "JCV_VP1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

t.mpv.mcv.vp1 <- data[c("FID", "IID", "MPV_initial_SD", "MCV_VP1_RINT", "alcintakefreq_initialassessment", "eversmoked_initialassessment", "BMI_initialassessment", "HDL_initialassessment", "LDL_initialassessment", "triglycerides_initialassessment", "sex", "age_initialrecruitment")]

#Remove NAs from each subsetted dataframe
t.plt.tg.sag1 <- na.omit(t.plt.TG.sag1)
t.plt.cmv.pp52 <- na.omit(t.plt.cmv.pp52)
t.plt.ebv.ead <- na.omit(t.plt.ebv.ead)
t.plt.ebv.ebna <- na.omit(t.plt.ebv.ebna)
t.plt.ebv.vcap18 <- na.omit(t.plt.ebv.vcap18)
t.plt.ebv.zebra <- na.omit(t.plt.ebv.zebra)
t.plt.hhv6.IE1A <- na.omit(t.plt.hhv6.IE1A)
t.plt.hhv7.u14 <- na.omit(t.plt.hhv7.u14)
t.plt.hsv1.1gG <- na.omit(t.plt.hsv1.1gG)
t.plt.vsv.gEgI <- na.omit(t.plt.vsv.gEgI)
t.plt.bkv.vp1 <- na.omit(t.plt.bkv.vp1)
t.plt.jcv.vp1 <- na.omit(t.plt.jcv.vp1)
t.plt.mcv.vp1 <- na.omit(t.plt.mcv.vp1)
t.mpv.tg.sag1 <- na.omit(t.mpv.TG.sag1)
t.mpv.cmv.pp52 <- na.omit(t.mpv.cmv.pp52)
t.mpv.ebv.ead <- na.omit(t.mpv.ebv.ead)
t.mpv.ebv.ebna <- na.omit(t.mpv.ebv.ebna)
t.mpv.ebv.vcap18 <- na.omit(t.mpv.ebv.vcap18)
t.mpv.ebv.zebra <- na.omit(t.mpv.ebv.zebra)
t.mpv.hhv6.IE1A <- na.omit(t.mpv.hhv6.IE1A)
t.mpv.hhv7.u14 <- na.omit(t.mpv.hhv7.u14)
t.mpv.hsv1.1gG <- na.omit(t.mpv.hsv1.1gG)
t.mpv.vsv.gEgI <- na.omit(t.mpv.vsv.gEgI)
t.mpv.bkv.vp1 <- na.omit(t.mpv.bkv.vp1)
t.mpv.jcv.vp1 <- na.omit(t.mpv.jcv.vp1)
t.mpv.mcv.vp1 <- na.omit(t.mpv.mcv.vp1)

#Perform linear regression of platelet phenotypes on common infection
#PLT on TG SAG1
obs.model.PLT.TG.SAG1 <- lm(PLT_initial_SD ~ TG_SAG1_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.tg.sag1)

summary(obs.model.PLT.TG.SAG1)
summary(obs.model.PLT.TG.SAG1)$coef[2] #Observational estimate
summary(obs.model.PLT.TG.SAG1)$coef[2,2] #Standard error of observational estimate

#PLT on CMV pp52
obs.model.CMV.pp52 <- lm(PLT_initial_SD ~ CMV_pp52_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.cmv.pp52)

summary(obs.model.CMV.pp52)
summary(obs.model.CMV.pp52)$coef[2] #Observational estimate
summary(obs.model.CMV.pp52)$coef[2,2] #Standard error of observational estimate

#PLT on EBV EA-D 
obs.model.EBV.EAD <- lm(PLT_initial_SD ~ EBV_EAD_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.ebv.ead)

summary(obs.model.EBV.EAD)
summary(obs.model.EBV.EAD)$coef[2] #Observational estimate
summary(obs.model.EBV.EAD)$coef[2,2] #Standard error of observational estimate

#PLT on EBV EBNA 
obs.model.EBV.EBNA <- lm(PLT_initial_SD ~ EBV_EBNA_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.ebv.ebna)

summary(obs.model.EBV.EBNA)
summary(obs.model.EBV.EBNA)$coef[2] #Observational estimate
summary(obs.model.EBV.EBNA)$coef[2,2] #Standard error of observational estimate

#PLT on EBV VCA p18
obs.model.EBV.VCAp18 <- lm(PLT_initial_SD ~ EBV_VCAp18_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.ebv.vcap18)

summary(obs.model.EBV.VCAp18)
summary(obs.model.EBV.VCAp18)$coef[2] #Observational estimate
summary(obs.model.EBV.VCAp18)$coef[2,2] #Standard error of observational estimate

#PLT on EBV ZEBRA
obs.model.EBV.ZEBRA <- lm(PLT_initial_SD ~ EBV_ZEBRA_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.ebv.zebra)

summary(obs.model.EBV.ZEBRA)
summary(obs.model.EBV.ZEBRA)$coef[2] #Observational estimate
summary(obs.model.EBV.ZEBRA)$coef[2,2] #Standard error of observational estimate

#PLT on HHV6 IE1A 
obs.model.HHV6.IE1A <- lm(PLT_initial_SD ~ HHV6_IE1A_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.hhv6.IE1A)

summary(obs.model.HHV6.IE1A)
summary(obs.model.HHV6.IE1A)$coef[2] #Observational estimate
summary(obs.model.HHV6.IE1A)$coef[2,2] #Standard error of observational estimate

#PLT on HHV7 U14 
obs.model.HHV7.U14 <- lm(PLT_initial_SD ~ HHV7_U14_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.hhv7.u14)

summary(obs.model.HHV7.U14)
summary(obs.model.HHV7.U14)$coef[2] #Observational estimate
summary(obs.model.HHV7.U14)$coef[2,2] #Standard error of observational estimate

#PLT on HSV1 1gG
obs.model.HSV1.1gG <- lm(PLT_initial_SD ~ HSV1_1gG_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.hsv1.1gG)

summary(obs.model.HSV1.1gG)
summary(obs.model.HSV1.1gG)$coef[2] #Observational estimate
summary(obs.model.HSV1.1gG)$coef[2,2] #Standard error of observational estimate

#PLT on VSV gE/GI
obs.model.VSV.gEgI <- lm(PLT_initial_SD ~ VSV_gEgI_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.vsv.gEgI)

summary(obs.model.VSV.gEgI)
summary(obs.model.VSV.gEgI)$coef[2] #Observational estimate
summary(obs.model.VSV.gEgI)$coef[2,2] #Standard error of observational estimate

#PLT on BKV VP1
obs.model.BKV.VP1 <- lm(PLT_initial_SD ~ BKV_VP1_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.bkv.vp1)

summary(obs.model.BKV.VP1)
summary(obs.model.BKV.VP1)$coef[2] #Observational estimate
summary(obs.model.BKV.VP1)$coef[2,2] #Standard error of observational estimate

#PLT on JCV VP1
obs.model.JCV.VP1 <- lm(PLT_initial_SD ~ JCV_VP1_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.jcv.vp1)

summary(obs.model.JCV.VP1)
summary(obs.model.JCV.VP1)$coef[2] #Observational estimate
summary(obs.model.JCV.VP1)$coef[2,2] #Standard error of observational estimate

#PLT on MCV VP1
obs.model.MCV.VP1 <- lm(PLT_initial_SD ~ MCV_VP1_RINT + eversmoked_initialassessment + BMI_initialassessment + HDL_initialassessment + LDL_initialassessment + triglycerides_initialassessment + sex + age_initialrecruitment, data = t.plt.mcv.vp1)

summary(obs.model.MCV.VP1)
summary(obs.model.MCV.VP1)$coef[2] #Observational estimate
summary(obs.model.MCV.VP1)$coef[2,2] #Standard error of observational estimate


